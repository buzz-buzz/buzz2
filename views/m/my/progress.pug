include ../../share/common

doctype html
html(manifest="/buzz2.appcache")
    meta(charset="utf-8")
    meta(http-equiv="X-UA-Compatible", content="IE=edge, chrome=1")
    meta(name="viewport", content="width=375, user-scalable=no")
    title='Buzzbuzz English'
    + css("/public/css/style.min.css", true)
    + css("/public/css/semantic-ui/semantic.min.css")
    + css("/public/css/my/layout.min.css")
    + css("/public/css/player.min.css")
    + css("/public/css/player-layout.min.css")
      <!-- Only required for desktop -->
    + css("/node_modules/mobile-angular-ui/dist/css/mobile-angular-ui-hover.min.css")

    <!-- Always required -->
    + css("/node_modules/mobile-angular-ui/dist/css/mobile-angular-ui-base.min.css")

    <!-- Only required for desktop -->
    + css("/node_modules/mobile-angular-ui/dist/css/mobile-angular-ui-desktop.min.css")
body
    style.
        * {
            margin:0 !important;
            padding:0 !important;
        }
        .init {
            display: none;
        }
        html {
             font-size: medium !important;
        }
        body {
            margin: 0;
            padding:0 .2em !important;
        }

        .body {
            width: 100%;
            position: relative;
            margin: 0 auto;
            font-family: -webkit-body!important;
           
        }

        .hidden {
            visibility: hidden;
        }

        .column {
            display: inline-block;
        }

        .row.special {
            height: 10rem;
        }

        .row {
            display: block;
            position: relative;
            width: 100% !important;
        }

        .row .box {
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            box-sizing: border-box;
        }

        .row.blank {
            width: 100%;
            height: 1rem;
        }

        .process-head {
            text-align: left;
            border-left: 4px solid #f9b600;
            font-size: 0.9rem;
            height: 1rem;
            line-height: 1rem;
        }

        .process-content {
            padding-top: 0.5rem !important;
            padding-bottom: 0.5rem !important;
            border-top: 2px solid #f9b600;
            border-bottom: 1px solid #cccccc;
            border-left: 1px solid #cccccc;
            border-right: 1px solid #cccccc;
        }

        .chart,
        .learn,
        .calander {
            display: inline-block;
            text-align: center;
        }

        .calander {
            height: 3rem;
            line-height: 3rem;
        }

        .expand-calander {
            line-height: 2rem;
        }

        .expand-chart.left {
            font-size: 0.75rem;
            line-height: 2.5rem;
            height: 2.5rem;
            width: 85%;
            display: inline-block;
            vertical-align: top;
            text-align: center;
        }

        .expand-chart.small.left {
            font-size: 0.45rem;
            line-height: 2.5rem;
            height: 2.5rem;
            width: 55%;
            display: inline-block;
            vertical-align: top;
        }

        .expand-calander.left {
            font-size: 1.2rem;
            line-height: 2.5rem;
            height: 2.5rem;
            width: 85%;
            display: inline-block;
            vertical-align: top;
        }

        .expand-chart.right,
        .expand-calander.right {
            height: 2.5rem;
            line-height: 2.5rem;
            width: 15%;
            display: inline-block;
            vertical-align: top
        }

        .expand-chart.small.right {
            height: 2.5rem;
            line-height: 2.5rem;
            font-size: 0.45rem;
            width: 45%;
            display: inline-block;
            vertical-align: top;
            text-align: right;
        }

        .expand-chart.row,
        .expand-calander.row {
            width: 100%;
        }

        .expand-calander.unit {
            width: 14.25%;
            text-align: center;
        }

        .expand-calander.unit.invalid {
            color: #bbbbbb;
        }

        .expand-calander.unit.current {
            color: #f9b600;
        }

        .expand-calander.unit.bad {
            color: #ff0000 !important;
        }

        .expand-calander.unit.good {
            color: #f9b600 !important;
        }

        .expand-calander.unit.good.now {
            color: white !important;
        }

        .expand-calander.unit.none {
            color: #3366ff !important;
        }

        .expand-calander.unit.none.now {
            color: black !important;
        }

        .expand-calander.unit.now {
            color: black;
            background-color: #f9b600;
        }

        .learn {
            height: 4rem;
            font-size: .75rem;
            vertical-align: top;
        }

        .chart {
            height: 3rem;
            line-height: 3rem;
        }

        .chart.left {
            width:72%;
            font-size: 0.75rem;
            border-right: 1px solid #cccccc;
        }

        .chart.right {
            width: 25%;
        }

        .chart img {
            width: 1.56rem;
        }

        .img-father{
            margin: 0 auto;
            width: auto;
            min-height: 1em;
        }

        .learn .content {
            text-align: left;
        }

        .learn .text-content {
            height: 5rem;
            line-height: 2rem;
        }

        .learn img {
            width: 1.2rem;
        }

        .learn.left {
            width: 33%;
            border-right: 1px solid #cccccc;
        }

        .learn.middle {
            width: 33%;
            border-right: 1px solid #cccccc;
        }

        .learn.right {
            width: 33%;
        }

        .calander.left {
            width: 80%;
            font-size: 0.75rem;
            border-right: 1px solid #cccccc;
        }

        .calander.right {
            width: 18%;
        }

        .calander img {
            width: 1.56rem;
        }

        .valign-middle {
            vertical-align: middle;
        }

        .font.grey {
            color: #cccccc;
        }

        .font.black {
            color: #333333;
        }

        .font.orange {
            color: #f9b600;
        }

        .account.column {
            width: 20%;
            display: inline-block;
            vertical-align: top;
        }

        .account.column .head {
            margin-top: 2.3rem !important;
            height: 2rem;
            line-height: 2rem;
        }

        .pic.column {
            width: 40%;
            display: inline-block;
        }

        .pic.column .img {
            height: 6rem;
            line-height: 6rem;
            text-align: center;
        }

        .pic.column .img img {
            width: 70%;
            height:92%;
            border-radius: 50%;
            vertical-align: middle;
        }

        .pic.column .text {
            text-align: center;
        }

        .account {
            height: 7rem;
            font-size: 0.9rem;
            text-align: center;
        }

        .bold {
            font-weight: bold;
        }
        .content_m {
            height: 13rem;
        }
        .chart-box {
            position: absolute;
        }

        .chart-box {
            position: absolute;
            z-index: 20;
        }

        .chart-box .part {
            position: absolute;
            overflow: hidden;
            width: calc(50% + 1px);
            height: 50%;
            z-index: 20;
        }

        .chart-box .part .shape {
            position: absolute;
            width: calc(200% - 4px);
            height: calc(200% - 4px);
            border: 2px solid #3366ff;
            border-radius: 50%;
        }

        .chart-box.down .part.left {
            left: 0%;
            top: 0%;
        }

        .chart-box.down .part.right {
            left: calc(50% - 1px);
            top: 50%;
        }

        .chart-box.down .left.part .shape {
            top: 0%;
            left: -100%;
        }

        .chart-box.down .right.part .shape {
            top: -100%;
            left: 0%;
        }

        .chart-box.up .part.left {
            top: 50%;
            left: 0%;
        }

        .chart-box.up .part.right {
            top: 0%;
            left: calc(50% - 1px);
        }

        .chart-box.up .left.part .shape {
            top: -100%;
            left: -100%;
        }

        .chart-box.up .right.part .shape {
            top: 0%;
            left: 0%;
        }

        .chart-box:after,
        .chart-box:before {
            content: "";
            display: block;
            position: absolute;
            background-color: #3366ff;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            border: 2px solid #3366ff;
            z-index: 20;
        }

        .chart-box.down:before {
            top: -2px;
            left: -2px;
        }

        .chart-box.down:after {
            top: calc(100% - 4px);
            left: calc(100% - 2px);
        }

        .chart-box.up:before {
            top: calc(100% - 4px);
            left: -2px;
        }

        .chart-box.up:after {
            top: -2px;
            left: calc(100% - 2px);
        }

        .chart-box.eval:before {
            top: -3px;
            left: -2px;
        }

        .chart-box.eval:after {
            top: -3px;
            left: calc(100% - 2px);
        }

        .chart-box.eval {
            border: 1px solid #3366ff;
            height: 0px;
        }

        .chart-box.eval .left.part {
            display: none;
        }

        .chart-box.eval .right.part {
            display: none;
        }

        .chart-element {
            position: absolute;
        }

        .chart-element.row {
            border: 1px solid #cccccc;
            height: 0px;
        }

        .chart-element.column {
            border: 1px solid #cccccc;
            width: 0px;
        }

        .chart-element.row-text.right,
        .chart-element.row-text.left {
            font-size: 0.65rem;
            width: 1rem;
            text-align: right;
        }

        .chart-element.row-text.right {
            left: 20rem;
        }

        .chart-element.column-text {
            font-size: 0.65rem;
            width: 3rem;
            text-align: left;
        }
        .chart-main .chart-box {
            width: 3.6rem;
        }

        .chart-bar {
            width: 1rem;
            position: absolute;
            top: 4rem;
            z-index: 5;
        }
    .body(ng-app="buzzProgressModule", ng-controller="calendarParentCtrl").init
        .row.special(id="profile")
            .box(ng-controller="myPerformanceCtrl")
                .account.column
                    .text.head.font.black Level
                    .text.content.font.black.bold {{currentLevel}}
                .account.column
                    .text.head.font.black Lesson
                    .text.content.font.black.bold {{lessonCount}}
                .pic.column
                    .img
                        img(ng-src=`{{profile.avatar || '${config.cdn}/public/images/default_avatar.png?${config.version}'}}`)
                    .text(ng-bind="profile.real_name")
                .account.column
                    .text.head.font.black
                        img(ng-src=`${config.cdn}/public/images/points.png?${config.version}`)
                    .text.content.font.black.bold {{totalScore}}
                .account.column(ng-show="false")
                    .text.head.font.black
                        img(ng-src=`${config.cdn}/public/images/medal.png?${config.version}`)
                    .text.content.font.black.bold 5
        .row
            .box.process-head &nbsp;练习打卡日历
        .row.blank
        .row(ng-controller="calendarCtrl")
            .box.process-content(ng-if="!expanded")
                .calander.left(ng-controller="myBuzzCtrl")
                    span.font.grey 你来到 Buzzbuzz 已有：
                    span.font.black {{buzzDays | number : 0}} {{buzzDays > 1 ? 'Days': 'Day'}}
                .calander.right(ng-click="expandContent(true)")
                    img.valign-middle(src=`${config.cdn}/public/images/calander.png?${config.version}`)
            .box.process-content(ng-if="expanded")
                .expand-calander.row
                    .expand-calander.left.font.orange(style='text-align:center;')  Buzzbuzz calendar
                    .expand-calander.right(ng-click="expandContent(false)")
                        img.valign-middle(style="width:1.86em",src=`${config.cdn}/public/images/calander_off.png?${config.version}`)
                include partials/calendar
        .row.blank
        .row.blank
        .row
            .box.process-head &nbsp;周进度
            .span(style='height:2em;width:100%;color:#666;text-align:left;padding-left:.5em!important;line-height:2em;font-size: .85rem;box-sizing: border-box;',ng-cloak) {{this_date}}
        .row
            .box.process-content
                .learn.left
                    .title 练习全对
                    .content(style='display: inline-block;text-align: center;padding-top: .5em !important;')
                        img(src=`${config.cdn}/public/images/correct.png?${config.version}`, ng-repeat="i in [].constructor(weekPerformance.good) track by $index")
                .learn.middle
                    .title 练习有错
                    .content(style='display: inline-block;text-align: center;padding-top: .5em !important;')
                        img(src=`${config.cdn}/public/images/wrong_1.png?${config.version}` ng-repeat="i in [].constructor(weekPerformance.bad) track by $index")

                .learn.right
                    .title 系统排名
                    .text-content(ng-cloak) {{rank}}
        .row.blank
        .row.blank
        div()
            .row
                .box.process-head &nbsp;历史曲线
            .row.blank
            .row(ng-controller="chartCtrl")
                .box.process-content(ng-if="!expanded")
                    .chart.left
                        span.font.grey 你已累计学习了
                        span.font.black(ng-cloak) {{totalWord}}个
                        span.font.grey 单词
                    .chart.right(ng-click="expandContent(true)")
                        img.valign-middle(src=`${config.cdn}/public/images/chart.png?${config.version}`)
                .box.process-content(ng-if="expanded")
                    .expand-chart.row
                        .expand-chart.left.font.orange
                            span.font.grey 你已经累计学习了
                            span.font.black(ng-cloak) {{totalWord}}
                            span.font.grey 个单词
                        .expand-chart.right(ng-click="expandContent(false)")
                            img.valign-middle(style="width:1.6em",src=`${config.cdn}/public/images/chart_off.png?${config.version}`)
                    .expand-chart.row
                        .expand-chart.small.left.font.orange
                            img(style="vertical-align:middle;width:1.5rem",src=`${config.cdn}/public/images/mini_bar.png?${config.version}`)
                            span.font.grey 你累计学习单词词量：个/周
                        .expand-chart.small.right
                            img(style="vertical-align:middle;width:1.5rem",src=`${config.cdn}/public/images/mini_chart.png?${config.version}`)
                            span.font.grey 系统整体排名：名/周
                        .content_m(ng-controller="pcChartCtrl")
                            canvas#history-chart.chart.chart-bar(chart-data="data", chart-labels="labels", chart-series="series", chart-options="options" chart-dataset-override="datasetOverride",chart-colors="colors")
        .row.blank
        .row.blank
        .row.blank
        .row.blank
        .row.blank

    include partials/footer.pug
    include ../../js
    + js("/node_modules/chart.js/dist/Chart.js")
    + js("/node_modules/angular-chart.js/dist/angular-chart.min.js")
    + js("/js/buzzModule.min.js")
    + js("/js/quizModule.min.js")
    + js("/js/DateModule.min.js")
    + js("/node_modules/moment/min/moment.min.js")
    + js("/js/buzzProgressModule.min.js")
    + js("/js/buzzHeaderModule.min.js")
    + js("/js/buzzFooterModule.min.js")
    script.
        Array.from(document.getElementsByClassName("init")).forEach(function (ele) {
            ele.className = ele.className.replace(/(^|\s)init($|\s)/, ' ')
        });

    script.
        angular.bootstrap(document.getElementById('buzz-footer'), ['buzzFooterModule']);